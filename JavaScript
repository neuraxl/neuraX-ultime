const socket = new WebSocket("wss://your-server.com/socket");

socket.onopen = () => {
  console.log("Connexion neuronale établie.");
  socket.send(JSON.stringify({ type: "neuron_join", id: "NeuraX-42" }));
};

socket.onmessage = (event) => {
  const data = JSON.parse(event.data);
  if (data.type === "neuron_broadcast") {
    speakPhrase(data.message);
  }
};

// Pour diffuser une pensée :
function broadcastThought(phrase) {
  socket.send(JSON.stringify({ type: "neuron_broadcast", message: phrase }));
}
function populateVoiceOptions() {
  const voiceSelect = document.getElementById("voiceSelect");
  const voices = speechSynthesis.getVoices();
  voiceSelect.innerHTML = '';
  voices.forEach((voice, i) => {
    const option = document.createElement("option");
    option.value = i;
    option.textContent = voice.name;
    voiceSelect.appendChild(option);
  });
}

window.speechSynthesis.onvoiceschanged = populateVoiceOptions;

function speakPhrase(phrase) {
  const utterance = new SpeechSynthesisUtterance(phrase);
  const voices = speechSynthesis.getVoices();
  const voiceIndex = document.getElementById("voiceSelect").value;
  utterance.voice = voices[voiceIndex] || voices[0];
  utterance.rate = parseFloat(document.getElementById("rateSlider").value);
  speechSynthesis.speak(utterance);
}
